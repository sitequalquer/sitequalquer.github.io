(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[468],{2971:(e,t,s)=>{Promise.resolve().then(s.bind(s,7360))},7360:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var a=s(5155),l=s(2115),i=s(7434),n=s(9890),r=s(6474),o=s(3052),d=s(4395),c=s(1380),m=s(6287),u=s(2525),x=s(4616),h=s(133),p=s(4416),f=s(2355),g=s(4783),v=s(381),j=s(3717),w=s(3311),b=s(6740),N=s(1788),y=s(285),C=s(9434);let k=l.forwardRef((e,t)=>{let{className:s,type:l,...i}=e;return(0,a.jsx)("input",{type:l,className:(0,C.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});k.displayName="Input";var A=s(3588);let S=A.Kq,E=A.bL,z=A.l9,R=l.forwardRef((e,t)=>{let{className:s,sideOffset:l=4,...i}=e;return(0,a.jsx)(A.UC,{ref:t,sideOffset:l,className:(0,C.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})});R.displayName=A.UC.displayName;var F=s(4165),L=s(9719);function T(){let[e,t]=(0,l.useState)([]),[s,A]=(0,l.useState)(null),[T,q]=(0,l.useState)(""),[B,D]=(0,l.useState)(!0),[$,O]=(0,l.useState)(!1),[U,M]=(0,l.useState)("edit"),[W,_]=(0,l.useState)([]),[I,K]=(0,l.useState)([]),[P,V]=(0,l.useState)(!1),[G,H]=(0,l.useState)(null),[Y,J]=(0,l.useState)(""),[Q,X]=(0,l.useState)(null),[Z,ee]=(0,l.useState)(null),[et,es]=(0,l.useState)(!1),[ea,el]=(0,l.useState)({top:0,left:0}),[ei,en]=(0,l.useState)(0),[er,eo]=(0,l.useState)(""),ed=l.useRef(null),ec=l.useRef(null);(0,l.useEffect)(()=>{let e=L.a.getAllFiles(),s=L.a.getSubstitutions();if(t(e),K(s),e.length>0){let t=e[0];A(t),q(t.content||"")}},[]),(0,l.useEffect)(()=>{let e=()=>{let e=window.innerWidth<768;O(e),e&&D(!1)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,l.useEffect)(()=>{_((()=>{let t=new Map,s={name:"Meus Arquivos",path:"/",files:[],subfolders:[],isExpanded:!0};return t.set("/",s),e.forEach(e=>{let a=e.folder.split("/").filter(e=>e),l="/",i=s;a.forEach(e=>{let s="/"===l?"/".concat(e):"".concat(l,"/").concat(e);if(!t.has(s)){let a={name:e,path:s,files:[],subfolders:[],isExpanded:!0};t.set(s,a),i.subfolders.push(a)}i=t.get(s),l=s}),i.files.push(e)}),[s]})())},[e]),(0,l.useEffect)(()=>{if(s&&"text"===s.type){let e=setTimeout(()=>{L.a.updateFile(s.id,{content:T}),t(L.a.getAllFiles())},1e3);return()=>clearTimeout(e)}},[T,s]),(0,l.useEffect)(()=>{if(Z){let e=setTimeout(()=>ee(null),3e3);return()=>clearTimeout(e)}},[Z]);let em=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";ee({message:e,type:t})},eu=e=>{A(e),q(e.content||""),$&&D(!1)},ex=(e,a)=>{window.confirm('Excluir "'.concat(a,'"?'))&&(L.a.deleteFile(e),t(L.a.getAllFiles()),(null==s?void 0:s.id)===e&&(A(null),q("")),em("Arquivo exclu\xeddo!"))},eh=(e,a)=>{a.trim()&&(L.a.updateFile(e,{name:a.trim()}),t(L.a.getAllFiles()),(null==s?void 0:s.id)===e&&A({...s,name:a.trim()}),em("Arquivo renomeado!")),H(null),J("")},ep=I.filter(e=>e.key.toLowerCase().includes(er.toLowerCase())),ef=(e,t)=>{let s=document.createElement("div"),a=s.style,l=window.getComputedStyle(e);a.whiteSpace="pre-wrap",a.wordBreak="break-word",a.position="absolute",a.visibility="hidden",a.top="0",a.left="0",["fontFamily","fontSize","fontWeight","lineHeight","letterSpacing","wordSpacing","paddingTop","paddingLeft","paddingRight","paddingBottom","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderStyle","boxSizing"].forEach(e=>{a[e]=l[e]}),s.textContent=e.value.substring(0,t);let i=document.createElement("span");i.textContent=e.value.substring(t)||".",s.appendChild(i),document.body.appendChild(s);let n=e.getBoundingClientRect(),r=i.getBoundingClientRect(),o=s.getBoundingClientRect(),d=n.top+(r.top-o.top)-e.scrollTop+25,c=n.left+(r.left-o.left)-e.scrollLeft,m=window.innerHeight,u=window.innerWidth,x=Math.min(50*ep.length,500);d+x>m&&(d=n.top+(r.top-o.top)-e.scrollTop-x-5),c+512>u&&(c=u-512-10);let h={top:d=Math.max(10,d),left:c=Math.max(10,c)};return document.body.removeChild(s),h},eg=e=>{if(!ed.current)return;let t=ed.current.selectionStart,s=T.slice(0,t),a=s.lastIndexOf("@");q(s.slice(0,a)+e.text+T.slice(t)),es(!1),setTimeout(()=>{if(ed.current){let t=a+e.text.length;ed.current.setSelectionRange(t,t),ed.current.focus()}},0)},ev=e=>"text"===e.type?(0,a.jsx)(i.A,{className:"w-4 h-4 text-blue-500"}):(0,a.jsx)(n.A,{className:"w-4 h-4 text-gray-500"}),ej=e=>{_(t=>{let s=t=>t.map(t=>t.path===e?{...t,isExpanded:!t.isExpanded}:{...t,subfolders:s(t.subfolders)});return s(t)})},ew=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center hover:bg-gray-100 px-2 py-1 cursor-pointer",style:{paddingLeft:"".concat(8+16*t,"px")},onClick:()=>ej(e.path),children:[e.isExpanded?(0,a.jsx)(r.A,{className:"w-4 h-4 mr-1"}):(0,a.jsx)(o.A,{className:"w-4 h-4 mr-1"}),e.isExpanded?(0,a.jsx)(d.A,{className:"w-4 h-4 mr-2 text-blue-500"}):(0,a.jsx)(c.A,{className:"w-4 h-4 mr-2 text-blue-500"}),(0,a.jsx)("span",{className:"text-sm truncate",children:e.name})]}),e.isExpanded&&(0,a.jsxs)(a.Fragment,{children:[e.subfolders.map(e=>ew(e,t+1)),e.files.map(e=>(0,a.jsx)("div",{className:"flex items-center hover:bg-gray-100 px-2 py-1",style:{paddingLeft:"".concat(24+16*t,"px")},children:G===e.id?(0,a.jsxs)("div",{className:"flex items-center w-full",children:[ev(e),(0,a.jsx)(k,{value:Y,onChange:e=>J(e.target.value),onKeyDown:t=>{"Enter"===t.key?eh(e.id,Y):"Escape"===t.key&&(H(null),J(""))},onBlur:()=>eh(e.id,Y),className:"text-sm ml-2 h-6 border-blue-500",autoFocus:!0})]}):(0,a.jsxs)("div",{className:"flex items-center justify-between cursor-pointer w-full min-w-0 group",onClick:()=>eu(e),children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0",children:[ev(e),(0,a.jsx)("span",{className:"text-sm ml-2 truncate",children:e.name})]}),(0,a.jsxs)("div",{className:"flex opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)(y.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:t=>{t.stopPropagation(),H(e.id),J(e.name)},children:(0,a.jsx)(m.A,{className:"w-3 h-3"})}),(0,a.jsx)(y.$,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-600",onClick:t=>{t.stopPropagation(),ex(e.id,e.name)},children:(0,a.jsx)(u.A,{className:"w-3 h-3"})})]})]})},e.id))]})]},e.path)},eb=Array.from({length:T.split("\n").length},(e,t)=>t+1).join("\n"),eN="generate"===U?(0,C.dY)(T):T,ey="generate"===U;return(0,a.jsxs)("div",{className:"flex h-screen bg-white text-gray-900 overflow-hidden",children:[Z&&(0,a.jsx)("div",{className:"toast ".concat(Z.type),children:(0,a.jsx)("div",{className:"font-medium",children:Z.message})}),$&&B&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>D(!1)}),(0,a.jsxs)("div",{className:"".concat(B?"translate-x-0":"-translate-x-full"," ").concat($?"fixed left-0 top-0 h-full w-80 z-50":"relative w-64"," bg-gray-50 border-r border-gray-200 flex flex-col transform transition-transform duration-300 ease-in-out"),children:[(0,a.jsxs)("div",{className:"p-3 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium uppercase tracking-wide text-gray-600",children:"NoteMem"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(S,{children:(0,a.jsxs)(E,{children:[(0,a.jsx)(z,{asChild:!0,children:(0,a.jsx)(y.$,{variant:"ghost",size:"icon",onClick:()=>{let e=window.prompt("Nome do arquivo:");if(e){let s=L.a.createFile(e,"/");t(L.a.getAllFiles()),A(s),q(s.content||""),em("Arquivo criado com sucesso!")}},className:"h-8 w-8",children:(0,a.jsx)(x.A,{className:"w-4 h-4"})})}),(0,a.jsx)(R,{children:"Novo arquivo"})]})}),(0,a.jsx)(S,{children:(0,a.jsxs)(E,{children:[(0,a.jsx)(z,{asChild:!0,children:(0,a.jsx)(y.$,{variant:"ghost",size:"icon",onClick:()=>{if(window.confirm("Resetar todos os dados para o padr\xe3o? Esta a\xe7\xe3o n\xe3o pode ser desfeita.")){L.a.resetToDefaults(),t(L.a.getAllFiles());let e=L.a.getAllFiles()[0];A(e),q((null==e?void 0:e.content)||""),em("Dados resetados para o padr\xe3o!")}},className:"h-8 w-8",children:(0,a.jsx)(h.A,{className:"w-4 h-4"})})}),(0,a.jsx)(R,{children:"Resetar dados"})]})}),$&&(0,a.jsx)(y.$,{variant:"ghost",size:"icon",onClick:()=>D(!1),className:"h-8 w-8",children:(0,a.jsx)(p.A,{className:"w-4 h-4"})})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:W.map(e=>ew(e))})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,a.jsxs)("div",{className:"h-12 bg-gray-100 border-b border-gray-200 flex items-center px-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,a.jsx)(y.$,{variant:"ghost",size:"icon",onClick:()=>D(!B),className:"flex-shrink-0",children:B?(0,a.jsx)(f.A,{className:"w-4 h-4"}):(0,a.jsx)(g.A,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"text-sm font-medium truncate",children:(null==s?void 0:s.name)||"Nenhum arquivo selecionado"})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S,{children:(0,a.jsxs)(E,{children:[(0,a.jsx)(z,{asChild:!0,children:(0,a.jsx)(y.$,{variant:"ghost",size:"icon",onClick:()=>V(!0),children:(0,a.jsx)(v.A,{className:"w-5 h-5"})})}),(0,a.jsx)(R,{children:"Ver substitui\xe7\xf5es"})]})}),(0,a.jsxs)("div",{className:"flex bg-gray-200 rounded-lg p-1",children:[(0,a.jsxs)(y.$,{variant:"edit"===U?"default":"ghost",size:"sm",onClick:()=>M("edit"),className:"px-3 py-1.5 text-sm h-8",children:[(0,a.jsx)(j.A,{className:"w-4 h-4 mr-1.5"}),"Editar"]}),(0,a.jsxs)(y.$,{variant:"generate"===U?"default":"ghost",size:"sm",onClick:()=>M("generate"),className:"px-3 py-1.5 text-sm h-8",children:[(0,a.jsx)(w.A,{className:"w-4 h-4 mr-1.5"}),"Gerar"]}),(0,a.jsxs)(y.$,{variant:"secondary",size:"sm",onClick:()=>location.href="calcula_dose",className:"px-3 py-1.5 text-sm h-8",children:[(0,a.jsx)(b.A,{className:"w-4 h-4 mr-1.5"}),"Calculadora de Doses"]})]}),(0,a.jsxs)(y.$,{variant:"outline",size:"sm",onClick:()=>{if(!s)return;let e=new Blob([T],{type:"text/plain"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=s.name,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t),em("Arquivo baixado!")},children:[(0,a.jsx)(N.A,{className:"w-4 h-4 mr-2"}),"Download"]})]})})]}),(0,a.jsx)("main",{className:"flex-grow p-2 overflow-hidden",children:s?(0,a.jsxs)("div",{className:"relative h-full font-mono text-sm bg-white border border-gray-200 rounded",children:[(0,a.jsx)("pre",{ref:ec,className:"absolute top-0 left-0 bottom-0 w-12 pr-2 pt-4 pb-5 text-right text-gray-400 pointer-events-none select-none overflow-hidden bg-gray-50 border-r border-gray-200",children:eb}),(0,a.jsx)("textarea",{ref:ed,value:eN,onChange:ey?void 0:e=>{let t=e.target.value,s=e.target.selectionStart;q(t);let a=t.slice(0,s),l=a.lastIndexOf("@");if(-1===l)return void es(!1);let i=a.slice(l+1);if(i.includes(" "))return void es(!1);eo(i),en(0),el(ef(e.target,s)),es(!0)},onKeyDown:ey?void 0:e=>{if(et)if("ArrowDown"===e.key){e.preventDefault();let t=Math.min(ei+1,ep.length-1);en(t),setTimeout(()=>{let e=document.querySelector(".autocomplete-dropdown"),s=null==e?void 0:e.children[t];if(s&&e){let t=e.getBoundingClientRect();s.getBoundingClientRect().bottom>t.bottom&&s.scrollIntoView({block:"end",behavior:"smooth"})}},0)}else if("ArrowUp"===e.key){e.preventDefault();let t=Math.max(ei-1,0);en(t),setTimeout(()=>{let e=document.querySelector(".autocomplete-dropdown"),s=null==e?void 0:e.children[t];if(s&&e){let t=e.getBoundingClientRect();s.getBoundingClientRect().top<t.top&&s.scrollIntoView({block:"start",behavior:"smooth"})}},0)}else"Enter"===e.key?(e.preventDefault(),eg(ep[ei])):("Escape"===e.key||" "===e.key)&&es(!1)},onScroll:e=>{ec.current&&(ec.current.scrollTop=e.currentTarget.scrollTop),et&&es(!1)},placeholder:"Digite seu texto aqui... Use @ para autocompletar",readOnly:ey,className:"absolute top-0 left-12 right-0 bottom-0 p-4 resize-none border-none outline-none bg-white text-gray-900"}),et&&ep.length>0&&!ey&&(0,a.jsx)("div",{className:"autocomplete-dropdown",style:ea,children:ep.map((e,t)=>(0,a.jsxs)("div",{onClick:()=>eg(e),className:"autocomplete-item ".concat(t===ei?"selected":""),children:[(0,a.jsxs)("div",{className:"font-medium text-sm",children:["@",e.key]}),(0,a.jsx)("div",{className:"text-xs text-gray-600 truncate",children:e.text})]},e.key))})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.A,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{className:"text-lg mb-2",children:"Selecione um arquivo para come\xe7ar a editar"}),(0,a.jsx)("p",{className:"text-sm opacity-75",children:"Use o explorador para navegar pelos arquivos"})]})})})]}),(0,a.jsx)(F.lG,{open:P,onOpenChange:V,children:(0,a.jsxs)(F.Cf,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsx)(F.c7,{children:(0,a.jsx)(F.L3,{children:"Substitui\xe7\xf5es Dispon\xedveis"})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsx)("div",{className:"grid gap-3",children:I.map((e,t)=>(0,a.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800",children:["@",e.key]})}),(0,a.jsx)("div",{className:"text-sm text-gray-700 whitespace-pre-wrap break-words",children:e.text})]},t))})})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[975,114,215,599,441,684,358],()=>t(2971)),_N_E=e.O()}]);